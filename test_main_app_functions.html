<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Main App Functions</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .btn {
            background: #007AFF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin: 8px 8px 8px 0;
        }
        .btn:hover {
            background: #0056b3;
        }
        .status {
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            margin: 5px 0;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test Main App Functions</h1>
        <p>Testing the main app functions that should be working.</p>
        
        <div class="container">
            <h3>üìä System Status</h3>
            <button class="btn" onclick="checkSystemStatus()">Check System Status</button>
            <div id="systemStatus"></div>
        </div>
        
        <div class="container">
            <h3>‚ö° Test Quick Setup</h3>
            <p>This should open the quick setup modal:</p>
            <button class="btn" onclick="testQuickSetupModal()">Test Quick Setup Modal</button>
            <div id="quickSetupStatus"></div>
        </div>
        
        <div class="container">
            <h3>üìÑ Test PDF Upload</h3>
            <p>This should open the file picker:</p>
            <input type="file" id="testPdfInput" accept=".pdf" style="margin: 10px 0;">
            <button class="btn" onclick="testPdfUpload()">Test PDF Upload</button>
            <div id="pdfUploadStatus"></div>
        </div>
        
        <div class="container">
            <h3>üîç Debug Console</h3>
            <button class="btn" onclick="showDebugInfo()">Show Debug Info</button>
            <div id="debugInfo"></div>
        </div>
    </div>

    <!-- Load required scripts in the same order as main app -->
    <script src="js/cards-convergent-v2-integration.js?v=1.0"></script>
    <script src="js/simple-cards-convergent.js"></script>
    <script src="js/statement-ingestion-wrapper.js"></script>
    <script src="js/ui.js?v=3.9"></script>

    <script>
        function checkSystemStatus() {
            const div = document.getElementById('systemStatus');
            let html = '';
            
            // Check all required functions
            const functions = [
                { name: 'window.CardsConvergentV2', obj: window.CardsConvergentV2 },
                { name: 'window.SimpleCardsConvergent', obj: window.SimpleCardsConvergent },
                { name: 'window.StatementIngestionWrapper', obj: window.StatementIngestionWrapper },
                { name: 'window.quickSetupCC', obj: window.quickSetupCC },
                { name: 'window.uploadStatement', obj: window.uploadStatement },
                { name: 'window.parseSummaryText', obj: window.parseSummaryText }
            ];
            
            functions.forEach(func => {
                const exists = typeof func.obj !== 'undefined';
                const status = exists ? 'success' : 'error';
                const icon = exists ? '‚úÖ' : '‚ùå';
                html += `<div class="status ${status}">${icon} ${func.name}: ${exists ? 'Available' : 'Missing'}</div>`;
            });
            
            div.innerHTML = html;
        }
        
        function testQuickSetupModal() {
            const div = document.getElementById('quickSetupStatus');
            div.innerHTML = '<div class="status info">üîÑ Testing quick setup modal...</div>';
            
            try {
                // Create a test account ID
                const testCardId = 'test-card-' + Date.now();
                
                // Check if function exists
                if (typeof window.quickSetupCC !== 'undefined') {
                    // Try to call the function
                    window.quickSetupCC(testCardId);
                    div.innerHTML = '<div class="status success">‚úÖ Quick setup modal function called successfully!</div>';
                } else {
                    div.innerHTML = '<div class="status error">‚ùå window.quickSetupCC function not found</div>';
                }
                
            } catch (error) {
                div.innerHTML = `<div class="status error">‚ùå Quick setup test failed: ${error.message}</div>`;
                console.error('Quick setup test error:', error);
            }
        }
        
        function testPdfUpload() {
            const div = document.getElementById('pdfUploadStatus');
            div.innerHTML = '<div class="status info">üîÑ Testing PDF upload...</div>';
            
            try {
                // Create a test account ID
                const testCardId = 'test-pdf-' + Date.now();
                
                // Check if function exists
                if (typeof window.uploadStatement !== 'undefined') {
                    // Try to call the function
                    window.uploadStatement(testCardId);
                    div.innerHTML = '<div class="status success">‚úÖ PDF upload function called successfully! (File picker should open)</div>';
                } else {
                    div.innerHTML = '<div class="status error">‚ùå window.uploadStatement function not found</div>';
                }
                
            } catch (error) {
                div.innerHTML = `<div class="status error">‚ùå PDF upload test failed: ${error.message}</div>`;
                console.error('PDF upload test error:', error);
            }
        }
        
        function showDebugInfo() {
            const div = document.getElementById('debugInfo');
            
            let html = '<div style="font-family: monospace; font-size: 12px; background: #f8f9fa; padding: 10px; border-radius: 4px;">';
            
            html += '<strong>Available Functions:</strong><br>';
            html += `window.CardsConvergentV2: ${typeof window.CardsConvergentV2}<br>`;
            html += `window.SimpleCardsConvergent: ${typeof window.SimpleCardsConvergent}<br>`;
            html += `window.StatementIngestionWrapper: ${typeof window.StatementIngestionWrapper}<br>`;
            html += `window.quickSetupCC: ${typeof window.quickSetupCC}<br>`;
            html += `window.uploadStatement: ${typeof window.uploadStatement}<br>`;
            html += `window.parseSummaryText: ${typeof window.parseSummaryText}<br>`;
            
            html += '<br><strong>Cards Convergent V2 Methods:</strong><br>';
            if (typeof window.CardsConvergentV2 !== 'undefined') {
                const methods = Object.getOwnPropertyNames(window.CardsConvergentV2);
                methods.forEach(method => {
                    html += `- ${method}<br>`;
                });
            } else {
                html += 'Not available<br>';
            }
            
            html += '</div>';
            
            div.innerHTML = html;
        }
        
        // Initialize
        checkSystemStatus();
    </script>
</body>
</html>





